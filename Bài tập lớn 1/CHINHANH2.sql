--------------------------------------------------
----  Note: Use user sys to run this script   ----
--------------------------------------------------

alter session set "_ORACLE_SCRIPT"=true;

------------------- Create user 
CREATE USER CHINHANH2 IDENTIFIED BY CHINHANH2;
GRANT CONNECT, RESOURCE, CREATE PUBLIC DATABASE LINK TO CHINHANH2;
GRANT UNLIMITED TABLESPACE TO CHINHANH2;

------------------- Create table
CREATE TABLE CHINHANH2.BRANCHES(
    BRANCH_ID VARCHAR2(10) PRIMARY KEY,
    BRANCH_NAME VARCHAR2(50) NOT NULL,
    BRANCH_ADDRESS VARCHAR2(200) NOT NULL
);

CREATE TABLE CHINHANH2.PRODUCTS(
    PRODUCT_ID VARCHAR2(10) PRIMARY KEY,
    PRODUCT_NAME VARCHAR2(50) NOT NULL,
    PRODUCT_PRICE NUMBER NOT NULL, 
    PRODUCT_DESCRIPTION VARCHAR2(200) NOT NULL,
    PRODUCT_TYPE VARCHAR2(50) NOT NULL,
    warranty_period NUMBER NOT NULL --SỐ tháng hạn bảo hành
);

CREATE TABLE CHINHANH2.CUSTOMERS(
    CUS_ID VARCHAR2(10) PRIMARY KEY,
    CUS_NAME VARCHAR2(50) NOT NULL,
    CUS_PHONE VARCHAR2(50) NOT NULL,
    CUS_GENDER VARCHAR2(10) NOT NULL,
    CUS_ADDRESS VARCHAR2(200) NOT NULL,
    BRANCH_ID VARCHAR2(10) NOT NULL,
    CONSTRAINT FK_BRANCH_ID_CUS FOREIGN KEY (BRANCH_ID) REFERENCES  CHINHANH2.BRANCHES(BRANCH_ID)
);

CREATE TABLE  CHINHANH2.EMPLOYEES(
    EMP_ID VARCHAR2(10) PRIMARY KEY,
    EMP_NAME VARCHAR2(50) NOT NULL,
    EMP_PHONE VARCHAR2(50) NOT NULL,
    EMP_DOB DATE NOT NULL, --date of birth
    EMP_GENDER VARCHAR2(10) NOT NULL,
    EMP_ADDRESS VARCHAR2(200) NOT NULL,
    EMP_SALARY NUMBER NOT NULL,
    BRANCH_ID VARCHAR2(10) NOT NULL,
    CONSTRAINT FK_BRANCH_ID_EMP FOREIGN KEY (BRANCH_ID) REFERENCES  CHINHANH2.BRANCHES(BRANCH_ID)
);

CREATE TABLE  CHINHANH2.ORDERS(
    ORDER_ID NUMBER PRIMARY KEY,
    CUS_ID VARCHAR2(10) NOT NULL,
    ORDER_DATE DATE NOT NULL,
    BRANCH_ID VARCHAR2(10) NOT NULL,
    EMPLOYEE_ID VARCHAR2(10) NOT NULL,
    TOTAL_PRICE NUMBER NOT NULL,
    CONSTRAINT FK_CUS_ID_ORDER FOREIGN KEY (CUS_ID) REFERENCES  CHINHANH2.CUSTOMERS(CUS_ID),
    CONSTRAINT FK_BRANCH_ID_ORDER FOREIGN KEY (BRANCH_ID) REFERENCES  CHINHANH2.BRANCHES(BRANCH_ID),
    CONSTRAINT FK_EMPLOYEE_ID_ORDER FOREIGN KEY (EMPLOYEE_ID) REFERENCES  CHINHANH2.EMPLOYEES(EMP_ID)
);

CREATE TABLE  CHINHANH2.ORDER_DETAILS(
    ORDER_ID NUMBER NOT NULL,
    PRODUCT_ID VARCHAR2(10) NOT NULL,
    QUANTITY NUMBER NOT NULL,
    PRICE NUMBER NOT NULL,
    CONSTRAINT FK_ORDER_ID_ORDERDETAIL FOREIGN KEY (ORDER_ID) REFERENCES  CHINHANH2.ORDERS(ORDER_ID),
    CONSTRAINT FK_PRODUCT_ID_ORDERDETAIL FOREIGN KEY (PRODUCT_ID) REFERENCES  CHINHANH2.PRODUCTS(PRODUCT_ID)
);

CREATE TABLE  CHINHANH2.WAREHOUSE_MANAGER(
    BRANCH_ID VARCHAR2(10) NOT NULL,
    PRODUCT_ID VARCHAR2(10) NOT NULL,
    DATE_UPDATE DATE NOT NULL,
    QUANTITY NUMBER NOT NULL,
    ManufactureDate date NOT NULL,
    CONSTRAINT PK_WAREHOUSE_MAN PRIMARY KEY (BRANCH_ID, PRODUCT_ID, DATE_UPDATE),
    CONSTRAINT FK_BRANCH_ID_MAN FOREIGN KEY (BRANCH_ID) REFERENCES  CHINHANH2.BRANCHES(BRANCH_ID),
    CONSTRAINT FK_PRODUCT_ID_MAN FOREIGN KEY (PRODUCT_ID) REFERENCES  CHINHANH2.PRODUCTS(PRODUCT_ID)
);

CREATE TABLE  CHINHANH2.WAREHOUSE_SALER(
    BRANCH_ID VARCHAR2(10) NOT NULL,
    PRODUCT_ID VARCHAR2(10) NOT NULL,
    PRODUCT_STATUS NUMBER NOT NULL, -- 1 là còn hàng, 0 là hết hàng
    CONSTRAINT FK_BRANCH_ID_SALE FOREIGN KEY (BRANCH_ID) REFERENCES  CHINHANH2.BRANCHES(BRANCH_ID),
    CONSTRAINT FK_PRODUCT_ID_SALE FOREIGN KEY (PRODUCT_ID) REFERENCES  CHINHANH2.PRODUCTS(PRODUCT_ID)
);


------------------- Trigger
-- Tạo trigger tự động thêm dữ liệu vào bảng WAREHOUSE_SALER khi có dữ liệu thêm vào bảng CHINHANH2.WAREHOUSE_MANAGER
CREATE OR REPLACE TRIGGER trg_warehouse_manager
AFTER INSERT ON  CHINHANH2.WAREHOUSE_MANAGER
FOR EACH ROW
DECLARE
    v_product_status NUMBER;
BEGIN
    -- Đặt giá trị cho v_product_status tùy thuộc vào điều kiện nào đó
    -- Trong ví dụ này, giả sử nếu QUANTITY > 0 thì PRODUCT_STATUS = 1, ngược lại PRODUCT_STATUS = 0
    IF :NEW.QUANTITY > 0 THEN
        v_product_status := 1;
    ELSE
        v_product_status := 0;
    END IF;

    INSERT INTO  CHINHANH2.WAREHOUSE_SALER VALUES (:NEW.BRANCH_ID, :NEW.PRODUCT_ID, v_product_status);
END;
/
CREATE OR REPLACE TRIGGER UPDATE_TOTAL_PRICE
BEFORE INSERT OR UPDATE OR DELETE ON CHINHANH2.ORDER_DETAILS
FOR EACH ROW
DECLARE
    v_total_price NUMBER;
BEGIN
    -- Tính tổng tiền cho order hiện tại
    SELECT NVL(SUM(QUANTITY * PRICE), 0) INTO v_total_price
    FROM CHINHANH2.ORDER_DETAILS
    WHERE ORDER_ID = :NEW.ORDER_ID;

    -- Cập nhật tổng tiền vào bảng ORDERS
    IF INSERTING THEN
        UPDATE CHINHANH2.ORDERS
        SET TOTAL_PRICE = v_total_price + :NEW.PRICE* :NEW.QUANTITY
        WHERE ORDER_ID = :NEW.ORDER_ID;
    ELSIF UPDATING THEN
        UPDATE CHINHANH2.ORDERS
        SET TOTAL_PRICE = v_total_price - :OLD.PRICE* :OLD.QUANTITY + :NEW.PRICE*:NEW.QUANTITY
        WHERE ORDER_ID = :NEW.ORDER_ID;
    ELSE
        UPDATE CHINHANH2.ORDERS
        SET TOTAL_PRICE = v_total_price - :OLD.PRICE* :OLD.QUANTITY
        WHERE ORDER_ID = :NEW.ORDER_ID;
    END IF;
END;
/

--
CREATE OR REPLACE TRIGGER SET_PRICE_BEFORE_INSERT
BEFORE INSERT ON CHINHANH2.ORDER_DETAILS
FOR EACH ROW
BEGIN
    -- Lấy giá trị PRODUCT_PRICE từ bảng PRODUCTS
    SELECT PRODUCT_PRICE INTO :NEW.PRICE
    FROM CHINHANH2.PRODUCTS
    WHERE PRODUCT_ID = :NEW.PRODUCT_ID;
EXCEPTION
    WHEN NO_DATA_FOUND THEN
        -- Xử lý trường hợp không tìm thấy sản phẩm
        :NEW.PRICE := NULL;
END;
/


------------------- Insert data
INSERT INTO  CHINHANH2.BRANCHES VALUES ('CN2', 'Chi nhanh 2', 'Nguyen Van Linh, Binh Thuan, Thu Duc');

INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH201', 'Nguyen Thi Huong', '0901234567', 'Nu', '123 Duong Pham Ngu Lao, Quan 1, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH202', 'Tran Van Nam', '0987654321', 'Nam', '456 Duong so 6, Quan 2, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH203', 'Le Thi Mai', '0912345678', 'Nu', '789 Duong Nguyen Thi Minh Khai, Quan 3, TP Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH204', 'Pham Van Hoang', '0978765432', 'Nam', '987 Duong So 12B, Quan 4, TP Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH205', 'Nguyen Thi Lan Anh', '0901122334', 'Nu', '654 Duong Ly Thuong Kiet, Quan 5, TP. HCM', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH206', 'Vo Van Duc', '0988777666', 'Nam', '321 Duong So 1, Quan 6, TP Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH207', 'Do Thi Ngoc', '0911223344', 'Nu', '555 Khu do thi Phu My Hung, Quan 7, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH208', 'Nguyen Van Khanh', '0977888999', 'Nam', '888 Duong So 3, Quan 8, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH209', 'Tran Thi Hang', '0901122334', 'Nu', '777 Duong So 22, Quan 9, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH210', 'Le Van Hai', '0988777666', 'Nam', '666 Duong Su Van Hanh, Quan 10, Ha Noi', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH211', 'Pham Van An', '0909876543', 'Nam', '567 Duong Nguyen Van Cu, Quan 1, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH212', 'Nguyen Thi Ngoc Tram', '0987654321', 'Nu', '789 Duong Vo Van Tan, Quan 2, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH213', 'Le Van Long', '0912345678', 'Nam', '234 Duong Le Van Sy, Quan 3, TP Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH214', 'Tran Thi Minh Chau', '0978765432', 'Nu', '876 Duong Cach Mang Thang Tam, Quan 4, TP Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH215', 'Nguyen Van Duc', '0901122334', 'Nam', '543 Duong Nguyen Van Qua, Quan 5, TP. HCM', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH216', 'Vo Thi Kim Ngan', '0988777666', 'Nu', '987 Duong Nguyen Trai, Quan 6, TP Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH217', 'Tran Van Hung', '0911223344', 'Nam', '321 Duong Le Loi, Quan 7, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH218', 'Do Van Thanh', '0977888999', 'Nam', '555 Duong Nguyen Huu Tho, Quan 8, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH219', 'Nguyen Thi My Linh', '0901122334', 'Nu', '111 Duong Nguyen Dinh Chieu, Quan 9, TP. Ho Chi Minh', 'CN2');
INSERT INTO CHINHANH2.CUSTOMERS VALUES ('KH220', 'Le Van Hien', '0988777666', 'Nam', '222 Duong Tran Hung Dao, Quan 10, Ha Noi', 'CN2');


INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV201', 'Nguyen Van An Phuoc', '0345215875', TO_DATE('05-10-2003', 'DD-MM-YYYY'),'Nam', 'Di An, Binh Duong', 8900000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV202', 'Tran Quoc Bao', '0315220145', TO_DATE('15-05-1985', 'DD-MM-YYYY'),'Nam', 'Quan 1, TP.HCM', 12500000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV203', 'Pham Thi Ha Chau', '091245111', TO_DATE('20-11-1992', 'DD-MM-YYYY'),'Nu', 'Quan 2, TP.HCM', 4500000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV204', 'Tran Thuy Nga', '0321555124', TO_DATE('08-03-1988', 'DD-MM-YYYY'),'Nu', 'Quan 3, TP.HCM', 6000000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV205', 'Ha Van Hien', '0344845784', TO_DATE('10-07-1995', 'DD-MM-YYYY'),'Nam', 'Quan 4, TP.HCM', 7840000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV206', 'Bui Bao Bich Thuy', '035929791', TO_DATE('12-12-1990', 'DD-MM-YYYY'),'Nu', 'Quan 5, TP.HCM', 9500000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV207', 'Nguyen Thi Thuy Ha', '036628823', TO_DATE('01-01-1991', 'DD-MM-YYYY'),'Nu', 'Quan 6, TP.HCM', 1000000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV208', 'Nguyen Tien Thanh', '0358475477', TO_DATE('02-02-1992', 'DD-MM-YYYY'),'Nam', 'Quan 7, TP.HCM', 12400000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV209', 'Nguyen Hai Tung', '0315781111', TO_DATE('03-03-1993', 'DD-MM-YYYY'),'Nam', 'Quan 8, TP.HCM', 11100000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV210', 'Le Van Tuan', '0345123456', TO_DATE('05-10-1990', 'DD-MM-YYYY'), 'Nam', 'Quan 1, TP.HCM', 10500000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV211', 'Nguyen Thi Mai Huong', '0315220145', TO_DATE('15-05-1982', 'DD-MM-YYYY'), 'Nu', 'Quan 2, TP.HCM', 13500000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV212', 'Tran Van Hoang', '091245111', TO_DATE('20-11-1995', 'DD-MM-YYYY'), 'Nam', 'Quan 3, TP.HCM', 8000000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV213', 'Pham Thi Thu Hien', '0321555124', TO_DATE('08-03-1987', 'DD-MM-YYYY'), 'Nu', 'Quan 4, TP.HCM', 9500000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV214', 'Le Van Tho', '0344845784', TO_DATE('10-07-1993', 'DD-MM-YYYY'), 'Nam', 'Quan 5, TP.HCM', 11000000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV215', 'Tran Thi Hoa', '035929791', TO_DATE('12-12-1990', 'DD-MM-YYYY'), 'Nu', 'Quan 6, TP.HCM', 7800000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV216', 'Nguyen Van Hau', '036628823', TO_DATE('01-01-1991', 'DD-MM-YYYY'), 'Nam', 'Quan 7, TP.HCM', 11200000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV217', 'Le Thi Thuy', '0358475477', TO_DATE('02-02-1992', 'DD-MM-YYYY'), 'Nu', 'Quan 8, TP.HCM', 12800000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV218', 'Nguyen Van Thanh', '0315781111', TO_DATE('03-03-1993', 'DD-MM-YYYY'), 'Nam', 'Quan 9, TP.HCM', 12000000, 'CN2');
INSERT INTO CHINHANH2.EMPLOYEES VALUES ('NV219', 'Le Thi Thu Hang', '0345222888', TO_DATE('04-04-1994', 'DD-MM-YYYY'), 'Nu', 'Quan 10, TP.HCM', 14000000, 'CN2');

INSERT INTO CHINHANH2.PRODUCTS VALUES ('P1',  'Tivi LED 4K 55 inch', 12000000, 'Tivi LED 4K 55 inch, Smart TV', 'Tivi', 24);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P2',  'May Lanh Inverter 1.5HP', 8500000, 'May lanh Inverter cong nghe moi', 'Dien lanh', 36);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P3',  'Tu Lanh Side by Side', 18000000, 'Tu lanh Side by Side, dung tich 600L', 'Dien lanh', 24);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P4',  'May Giat Front Load 8kg', 9500000, 'May giat cong suat lon, tiet kiem nang luong', 'Gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P5',  'Bep Dien Tu 2 Bep', 3500000, 'Bep dien tu 2 bep, chong trao nguoc', 'Bep', 18);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P6',  'Quat Dien Cot', 800000, 'Quat cot, 3 toc do', 'Dien gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P7',  'May Xay Ca Phe', 1200000, 'May xay ca phe chuyen nghiep', 'Pha ca phe', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P8',  'Lo Nuong Dien 32L', 2800000, 'Lo nuong dien dung tich lon', 'Bep', 24);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P9',  'May Hut Bui Robot', 3500000, 'May hut bui tu dong, thong minh', 'Dien gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P10', 'May Pha Ca Phe Espresso', 5500000, 'May pha ca phe espresso chuyen nghiep', 'Pha ca phe', 18);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P11', 'Dieu Hoa Inverter 2HP', 10500000, 'Dieu hoa Inverter cong nghe moi', 'Dien lanh', 36);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P12', 'Binh Dun Nuoc Sieu Toc', 350000, 'Binh dun nuoc sieu toc, tu dong tat khi soi', 'Dien gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P13', 'May Ep Trai Cay', 2200000, 'May ep trai cay chat luong cao', 'Dien gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P14', 'Tu Say Quan Ao', 2000000, 'Tu say quan ao, cong nghe lam kho nhanh', 'Dien gia dung', 24);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P15', 'Ban La Hoi Nuoc', 1200000, 'Ban la hoi nuoc chat luong cao', 'Gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P16', 'Den LED Trang Tri', 500000, 'Den LED trang tri nhieu mau sac', 'Den', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P17', 'Loa Bluetooth Di Dong', 800000, 'Loa Bluetooth di dong, am thanh song dong', 'Am thanh', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P18', 'May Say Toc Ion', 450000, 'May say toc ion, bao ve toc khoi hu ton', 'Dien gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P19', 'O Cam Dien Thong Minh', 250000, 'O cam dien thong minh, dieu khien tu xa', 'Dien gia dung', 12);
INSERT INTO CHINHANH2.PRODUCTS VALUES ('P20', 'Quat Dung Cao Cap', 1200000, 'Quat dung cao cap, che do gio tu nhien', 'Dien gia dung', 24);

INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P1'  , TO_DATE('15-01-2023', 'DD-MM-YYYY'), 50, TO_DATE('01-01-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P2'  , TO_DATE('20-02-2023', 'DD-MM-YYYY'), 30, TO_DATE('01-02-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P3'  , TO_DATE('10-03-2023', 'DD-MM-YYYY'), 400, TO_DATE('01-03-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P4'  , TO_DATE('05-04-2023', 'DD-MM-YYYY'), 250, TO_DATE('01-04-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P5'  , TO_DATE('12-05-2023', 'DD-MM-YYYY'), 600, TO_DATE('01-05-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P6'  , TO_DATE('18-06-2023', 'DD-MM-YYYY'), 350, TO_DATE('01-06-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P7'  , TO_DATE('01-07-2023', 'DD-MM-YYYY'), 0, TO_DATE('01-07-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P8'  , TO_DATE('14-08-2023', 'DD-MM-YYYY'), 200, TO_DATE('01-08-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P9'  , TO_DATE('30-09-2023', 'DD-MM-YYYY'), 550, TO_DATE('01-09-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P10' , TO_DATE('22-10-2023', 'DD-MM-YYYY'), 280, TO_DATE('01-10-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P11' , TO_DATE('17-11-2023', 'DD-MM-YYYY'), 0, TO_DATE('01-11-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P12' , TO_DATE('05-12-2023', 'DD-MM-YYYY'), 420, TO_DATE('01-12-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P13' , TO_DATE('08-01-2023', 'DD-MM-YYYY'), 330, TO_DATE('01-01-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P14' , TO_DATE('14-02-2023', 'DD-MM-YYYY'), 480, TO_DATE('01-02-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P15' , TO_DATE('19-03-2023', 'DD-MM-YYYY'), 220, TO_DATE('01-03-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P16' , TO_DATE('25-04-2023', 'DD-MM-YYYY'), 0, TO_DATE('01-04-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P17' , TO_DATE('30-05-2023', 'DD-MM-YYYY'), 500, TO_DATE('01-05-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P18' , TO_DATE('10-06-2023', 'DD-MM-YYYY'), 260, TO_DATE('01-06-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P19' , TO_DATE('15-07-2023', 'DD-MM-YYYY'), 430, TO_DATE('01-07-2022', 'DD-MM-YYYY'));
INSERT INTO CHINHANH2.WAREHOUSE_MANAGER VALUES ('CN2', 'P20' , TO_DATE('20-08-2023', 'DD-MM-YYYY'), 290, TO_DATE('01-08-2022', 'DD-MM-YYYY'));

-- Dữ liệu cho bảng CHINHANH2.ORDERS
INSERT INTO CHINHANH2.ORDERS VALUES (11, 'KH211', TO_DATE('11-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV213', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (12, 'KH212', TO_DATE('12-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV214', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (13, 'KH213', TO_DATE('13-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV215', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (14, 'KH211', TO_DATE('14-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV216', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (15, 'KH211', TO_DATE('15-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV217', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (16, 'KH216', TO_DATE('16-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV218', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (17, 'KH217', TO_DATE('17-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV219', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (18, 'KH212', TO_DATE('18-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV220', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (19, 'KH219', TO_DATE('19-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV221', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (20, 'KH215', TO_DATE('20-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV213', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (21, 'KH216', TO_DATE('21-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV221', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (22, 'KH215', TO_DATE('22-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV213', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (23, 'KH214', TO_DATE('23-01-2023', 'DD-MM-YYYY'), 'CN2', 'NV214', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (24, 'KH213', TO_DATE('20-10-2023', 'DD-MM-YYYY'), 'CN2', 'NV215', 0);
INSERT INTO CHINHANH2.ORDERS VALUES (25, 'KH212', TO_DATE('20-10-2023', 'DD-MM-YYYY'), 'CN2', 'NV216', 0);

-- Dữ liệu cho bảng CHINHANH2.ORDER_DETAILS
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (11, 'P1', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (11, 'P2', 4, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (11, 'P3', 5, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (12, 'P4', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (12, 'P5', 1, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (13, 'P6', 4, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (14, 'P7', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (14, 'P8', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (15, 'P9', 5, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (15, 'P10', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (16, 'P11', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (16, 'P12', 4, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (16, 'P13', 1, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (17, 'P14', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (18, 'P15', 4, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (18, 'P16', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (19, 'P17', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (19, 'P18', 5, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (20, 'P19', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (20, 'P20', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (21, 'P1', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (21, 'P2', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (21, 'P3', 4, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (21, 'P4', 1, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (21, 'P5', 2, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (21, 'P6', 3, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (22, 'P7', 1, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (23, 'P8', 4, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (24, 'P9', 5, 0);
INSERT INTO CHINHANH2.ORDER_DETAILS VALUES (25, 'P10', 2, 0);

------------------- Create user
CREATE USER DIRECTOR IDENTIFIED BY DIRECTOR;
GRANT CONNECT, CREATE PUBLIC DATABASE LINK TO DIRECTOR;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.BRANCHES TO DIRECTOR;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.PRODUCTS TO DIRECTOR;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.CUSTOMERS TO DIRECTOR;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.EMPLOYEES TO DIRECTOR;
GRANT SELECT ON CHINHANH2.ORDERS TO DIRECTOR;
GRANT SELECT ON CHINHANH2.ORDER_DETAILS TO DIRECTOR;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.WAREHOUSE_MANAGER TO DIRECTOR;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.WAREHOUSE_SALER TO DIRECTOR;

CREATE USER WAREHOUSE_MANAGER IDENTIFIED BY WAREHOUSE_MANAGER;
GRANT CONNECT TO WAREHOUSE_MANAGER;
GRANT SELECT ON CHINHANH2.BRANCHES TO WAREHOUSE_MANAGER;
GRANT SELECT, INSERT, UPDATE ON CHINHANH2.PRODUCTS TO WAREHOUSE_MANAGER;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.WAREHOUSE_MANAGER TO WAREHOUSE_MANAGER;
GRANT SELECT, INSERT, UPDATE, DELETE ON CHINHANH2.WAREHOUSE_SALER TO WAREHOUSE_MANAGER;

CREATE USER EMPLOYEE IDENTIFIED BY EMPLOYEE;
GRANT CONNECT TO EMPLOYEE;
GRANT SELECT ON CHINHANH2.BRANCHES TO EMPLOYEE;
GRANT SELECT ON CHINHANH2.PRODUCTS TO EMPLOYEE;
GRANT SELECT ON CHINHANH2.CUSTOMERS TO EMPLOYEE;
GRANT SELECT ON CHINHANH2.ORDERS TO EMPLOYEE;
GRANT SELECT ON CHINHANH2.ORDER_DETAILS TO EMPLOYEE;
GRANT SELECT ON CHINHANH2.WAREHOUSE_SALER TO EMPLOYEE;

------------------- Create database link SERVICE_NAME:       CHINHANH_02_01
CREATE DATABASE LINK DIRECTOR_LINK CONNECT TO DIRECTOR IDENTIFIED BY DIRECTOR USING 'CHINHANH_02_01';
CREATE DATABASE LINK WAREHOUSE_MANAGER_LINK CONNECT TO WAREHOUSE_MANAGER IDENTIFIED BY WAREHOUSE_MANAGER USING 'CHINHANH_02_01';
CREATE DATABASE LINK EMPLOYEE_LINK CONNECT TO EMPLOYEE IDENTIFIED BY EMPLOYEE USING 'CHINHANH_02_01';











------------------- Other command
SELECT * FROM CHINHANH2.CUSTOMERS;
SELECT * FROM CHINHANH2.EMPLOYEES;
SELECT * FROM CHINHANH2.BRANCHES;
SELECT * FROM CHINHANH2.ORDERS;
SELECT * FROM CHINHANH2.ORDER_DETAILS;
SELECT * FROM CHINHANH2.PRODUCTS;
SELECT * FROM CHINHANH2.WAREHOUSE_MANAGER;
SELECT * FROM CHINHANH2.WAREHOUSE_SALER;


DROP TABLE CHINHANH2.WAREHOUSE_MANAGER CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.WAREHOUSE_SALER CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.ORDER_DETAILS CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.ORDERS CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.EMPLOYEES CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.CUSTOMERS CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.PRODUCTS CASCADE CONSTRAINTS;
DROP TABLE CHINHANH2.BRANCHES CASCADE CONSTRAINTS;